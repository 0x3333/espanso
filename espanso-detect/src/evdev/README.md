This is a great starting point for wayland support:
https://github.com/xkbcommon/libxkbcommon/blob/master/tools/interactive-evdev.c